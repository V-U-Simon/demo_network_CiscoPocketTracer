---
aliases: [ ]
created: 2022.09.28 10:03:30 –≤–µ—á–µ—Ä–∞
modified: 2022.09.28 11:22:51 –≤–µ—á–µ—Ä–∞
---
#üåênetwork

>[!cite]- Source
> - [PORT FORWARDING: –¢–ï–û–†–ò–Ø –ò –ù–ê–°–¢–†–û–ô–ö–ê CISCO](https://wiki.merionet.ru/seti/14/port-forwarding-teoriya-i-nastrojka-cisco/?ysclid=l7w2sznn7x239314828#)
> - [NAT –Ω–∞ Cisco. –ß–∞—Å—Ç—å 1](https://habr.com/ru/post/108931/?ysclid=l7w2tk3tcr85297178)

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π [[üåê NAT|üåê NAT –∏ üåê PAT]] –Ω–∞ [[üì° cisco|cisco]]

```Bash
show ip nat statistics     # üëÄ –ø—Ä–æ—Å–º–æ—Ç—Ä inside/outside –∏–Ω—Ç–µ—Ä—Ñ–µ—Å–æ–≤
show ip nat translations   # üëÄ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π NAT
# Pro	Inside Global		    Inside Local	Outside local		    Outside global
# tcp	212.193.249.136:8080	192.168.1.10:80	212.193.249.17:46088	212.193.249.17:46088 

no ip nat create flow-entries #  –û—Ç–∫–ª—é—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–∏ –æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏ 
ip nat translation ? # ‚è±Ô∏è –∏–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è NAT

clear ip nat translation * # ‚ùå —É–¥–∞–ª–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ NAT
```

# –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π

Static NAT

```Bash
# 1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏ –ú–∞—Ä–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
interface GigabitEthernet0/0/0
ip address 8.8.8.1 255.255.255.0
ip nat outside # —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
duplex auto
speed auto

interface GigabitEthernet0/0/1
ip address 192.168.0.1 255.255.255.0
ip nat inside # —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
duplex auto
speed auto

# 2. –°–æ–∑–¥–∞–µ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é | Static NAT
ip nat inside source static 192.168.0.100 7.7.7.1     # —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è 192.168.0.100 –≤ 7.7.7.1
#                           ^ —á—Ç–æ         ^ –∫—É–¥–∞
```

Static PAT

```Bash
# 1. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏ –ú–∞—Ä–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
# 2. –°–æ–∑–¥–∞–µ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é | static PAT (Port Forwarding)
ip nat inside source static tcp 192.168.0.100 80  6.6.6.1 80  # —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è 192.168.0.100:80  –≤ 6.6.6.1:80 
ip nat inside source static tcp 192.168.0.101 443 6.6.6.1 443 # —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—è 192.168.0.101:443 –≤ 6.6.6.1:443
#                           ^ —á—Ç–æ                 ^ –∫—É–¥–∞
```

# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π

Dynamic NAT

```Bash
# inside source dynamic NAT
# 1. –£–∫–∞–∑—ã–≤–∞–µ–º¬†—á—Ç–æ¬†—Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å (Access list)
# ip access-list standard NAME # –ø—Ä–∏–º–µ—Ä –∏–º–µ–Ω–∏ (ACL_NAME) - NET_10.0.0.0/24
access-list 100 permit tcp 192.168.0.0 0.0.0.255 any # —Å–æ–∑–¥–∞–µ–º access-list, –ø–µ—Ä–µ—á–∏—Å–ª—è—é—â–∏–π —Ç—Ä–∞—Ñ–∏–∫


# 2. –£–∫–∞–∑—ã–≤–∞–µ–º –∫—É–¥–∞ —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å (–°–æ–∑–¥–∞–µ–º –ø—É–ª –∏–∑ –∞–¥—Ä–µ—Å–æ–≤)
ip nat pool NAME_OF_POOL 11.1.1.10 11.1.1.20 netmask 255.255.255.0 # –æ—Ç 11.1.1.10 –¥–æ 11.1.1.20 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ


# 3. –ú–∞—Ä–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
interface fa 0/0
ip nat inside

interface fa 0/1  
ip nat outside


# 4. –°–æ–∑–¥–∞–µ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é
ip nat inside source list 100 pool NAME_OF_POOL # –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å IP-–∞–¥—Ä–µ—Å–∞
#                    ^ —á—Ç–æ     ^ –∫—É–¥–∞


# 5. –†–µ–∑—É–ª—å—Ç–∞—Ç
sh ip nat translations¬†# –æ–±—Ä–∞—Ç–∏–º—Å—è —Å —Ö–æ—Å—Ç–∞ 10.1.1.1 –∫ —Ö–æ—Å—Ç—É 11.1.1.2 
#     –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–æ—Å–ª–µ   –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–æ     –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ  –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ
# Pro Inside global    Inside local    Outside local  Outside global  
# tcp 11.1.1.10:55209  10.0.1.1:55209  11.1.1.2:23    11.1.1.2:23
# 
#     –∏–∑ —Ä–æ—É—Ç–µ—Ä–∞       –≤ —Ä–æ—É—Ç–µ—Ä
```

Dynamic PAT

```Bash
# inside source dynamic NAT with overload
# 1. –£–∫–∞–∑—ã–≤–∞–µ–º,¬†—á—Ç–æ¬†—Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å (Access list - NAME)
# 2. –£–∫–∞–∑—ã–≤–∞–µ–º –∫—É–¥–∞ —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å (–°–æ–∑–¥–∞–µ–º –ø—É–ª –∏–∑ –∞–¥—Ä–µ—Å–æ–≤, –µ—Å–ª–∏ –æ–¥–∏–Ω —Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º)
# 3. –ú–∞—Ä–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã 
# 4. –°–æ–∑–¥–∞–µ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏—é | –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –±—É–¥–µ—Ç –º–µ–Ω—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ IP-–∞–¥—Ä–µ—Å–∞, –Ω–æ –∏ –ø–æ—Ä—Ç—ã
ip nat inside source list NAME pool NAME_OF_POOL overload # –µ—Å–ª–∏ –ø—É–ª  IP
ip nat inside source list NAME int fa0/1         overload # –µ—Å–ª–∏ –æ–¥–∏–Ω IP
#                    ^ —á—Ç–æ     ^ –∫—É–¥–∞


# 5. –†–µ–∑—É–ª—å—Ç–∞—Ç
sh ip nat translations¬†  
#     –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–æ—Å–ª–µ   –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–æ     –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥–æ  –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ
# Pro Inside global    Inside local    Outside local  Outside global  
# tcp 11.1.1.11:21545  10.0.1.1:21545  11.1.1.2:23    11.1.1.2:23  
# tcp 11.1.1.11:49000  10.0.2.1:49000  11.1.1.2:23    11.1.1.2:23
```
